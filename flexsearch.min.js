/*
 https://github.com/nextapps-de/flexsearch
 @version: 0.1.27
 @license: Apache 2.0 Licence
*/
'use strict';(function(m,x,e){var c;(c=e.define)&&c.amd?c([],function(){return x}):(c=e.modules)?c[m.toLowerCase()]=x:"undefined"!==typeof module?module.exports=x:e[m]=x})("FlexSearch",function E(m){function e(a){a||(a=n);this.id=a.id||F++;this.init(a);Object.defineProperty(this,"index",{get:function(){return this.a}});Object.defineProperty(this,"length",{get:function(){return Object.keys(this.a).length}})}function c(a){return new RegExp(a,"g")}function p(a,b,d){if("undefined"===typeof d){for(d=0;d<
b.length;d+=2)a=a.replace(b[d],b[d+1]);return a}return a.replace(b,d)}function t(a,b,d,h,c){b[d]||(b[d]="1",b=c.indexOf(d),a=a[3/c.length*(c.length-b)+6/(b-c.lastIndexOf(" ",b))+.5|0],a=a[d]||(a[d]=[]),a[a.length]=h)}function z(a){for(var b="",d="",h="",c=0;c<a.length;c++){var f=a[c];f!==d&&(0<c&&" "!==f&&"h"===f?(h="a"===h||"e"===h||"i"===h||"o"===h||"u"===h||"y"===h,"a"!==d&&"e"!==d&&"i"!==d&&"o"!==d&&"u"!==d&&"y"!==d||!h||(b+=f)):b+=f);h=c===a.length-1?"":a[c+1];d=f}return b}function v(a,b){a=
a.length-b.length;return 0>a?1:0<a?-1:0}function G(a,b){a=a.length-b.length;return 0>a?-1:0<a?1:0}function H(a,b,d){var h=a.length,c=b.length,f=[];if(h&&c)for(var k=0,l=0;l<h;l++)for(var g=a[l],e=0;e<c;e++)if(b[e]===g){f[k++]=g;if(d&&k===d)return f;break}return f}function A(a){a.v||(a.v=B(function(){a.v=null;var b=a.async;b&&(a.async=!1);if(a.c.length){for(var d=C(),h;(h=a.c.shift())||0===h;){var c=a.g[h];switch(c[0]){case y.add:a.add(c[1],c[2]);break;case y.update:a.update(c[1],c[2]);break;case y.remove:a.remove(c[1])}a.g[h]=
null;delete a.g[h];if(100<C()-d)break}a.c.length&&A(a)}b&&(a.async=b)},1,"search-async-"+a.id))}function C(){return"undefined"!==typeof performance?performance.now():(new Date).getTime()}function I(a,b,d,c){a=m("flexsearch","id"+a,function(){var a,b;self.a=function(d){if(d=d.data)b.debug&&console.log("Worker Job Started: "+d.id),d.search?self.postMessage({result:b.search(d.content,d.limit),id:a,content:d.content,limit:d.limit}):d.add?b.add(d.id,d.content):d.update?b.update(d.id,d.content):d.remove?
b.remove(d.id):d.reset?b.reset():d.info?(d=b.info(),d.worker=a,b.debug&&console.log(d)):d.register&&(a=d.id,d.options.cache=!1,d.options.async=!0,d.options.worker=!1,b=(new Function(d.register.substring(d.register.indexOf("{")+1,d.register.lastIndexOf("}"))))(d.options))}},function(a){(a=a.data)&&a.result?c(a.id,a.content,a.result,a.limit):d.debug&&console.log(a)},b);var h=E.toString();d.id=b;a.postMessage(b,{register:h,options:d,id:b});return a}var n={type:"integer",mode:"forward",boolean:!1,cache:!1,
async:!1,worker:!1,encode:!1,debug:!0},u=[],F=0,y={add:0,update:1,remove:2},D=c("[ -/]");e.new=function(a){return new this(a)};e.create=function(a){return e.new(a)};e.addMatcher=function(a){for(var b in a)a.hasOwnProperty(b)&&(u[u.length]=c(b),u[u.length]=a[b]);return this};e.register=function(a,b){q[a]=b;return this};e.encode=function(a,b){return q[a](b)};e.prototype.init=function(a){this.l=[];if(a){if(a.worker)if("undefined"===typeof Worker)a.worker=!1,a.async=!0,this.i=null;else{var b=this,d=parseInt(a.worker,
10)||4;b.o=-1;b.m=0;b.h=[];b.u=null;b.i=Array(d);for(var c=0;c<d;c++)b.i[c]=I(b.id,c,a||n,function(a,d,c,h){b.m!==b.worker&&(b.h=b.h.concat(c),b.m++,h&&b.h.length>=h&&(b.m=b.worker),b.u&&b.m===b.worker&&(b.h.length?b.f="":b.f||(b.f=d),b.cache&&b.j.set(d,b.h),b.u(b.h),b.h=[]))})}this.mode=a.mode||this.mode||n.mode;this.boolean="or"===a["boolean"]||this.boolean||n.boolean;this.cache=a.cache||this.cache||n.cache;this.async=a.async||this.async||n.async;this.worker=a.worker||this.worker||n.worker;this.encoder=
a.encode&&q[a.encode]||this.encoder||n.encode&&q[n.encode]||a.encode;this.debug=a.debug||this.debug||n.debug;a.matcher&&this.addMatcher(a.matcher)}this.b=[{},{},{},{},{},{},{},{},{},{}];this.a={};this.g={};this.c=[];this.v=null;this.f="";this.s=!0;this.j=this.cache?new J(3E4,50,!0):!1;return this};e.prototype.encode=function(a){a&&u.length&&(a=p(a,u));a&&this.l.length&&(a=p(a,this.l));a&&this.encoder&&(a=this.encoder(a));return a};e.prototype.addMatcher=function(a){for(var b in a)a.hasOwnProperty(b)&&
(this.l[this.l.length]=c(b),this.l[this.l.length]=a[b]);return this};e.prototype.add=function(a,b){if("string"===typeof b&&b&&(a||0===a))if(this.a[a])this.update(a,b);else{if(this.worker)return++this.o>=this.i.length&&(this.o=0),this.i[this.o].postMessage(this.o,{add:!0,id:a,content:b}),this.a[a]=""+this.o,this;if(this.async)return this.g[a]||(this.c[this.c.length]=a),this.g[a]=[y.add,a,b],A(this),this;b=this.encode(b);if(!b.length)return this;for(var d={},c=b.constructor===Array?b:b.split(D),e=0;e<
c.length;e++){var f=c[e];if(f){var k=f.length;switch(this.mode){case "inverse":case "both":for(var l="",g=k-1;1<=g;g--)l=f[g]+l,t(this.b,d,l,a,b);case "forward":l="";for(g=0;g<k;g++)l+=f[g],t(this.b,d,l,a,b);break;case "full":for(g=0;g<k;g++)for(var m=k;m>g;m--)l=f.substring(g,m),t(this.b,d,l,a,b);break;default:t(this.b,d,f,a,b)}}}this.a[a]="1";this.s=!1}return this};e.prototype.update=function(a,b){if("string"===typeof b&&(a||0===a)&&this.a[a]){if(this.worker){var d=parseInt(this.a[a],10);this.i[d].postMessage(d,
{update:!0,id:a,content:b});return this}if(this.async)return this.g[a]||(this.c[this.c.length]=a),this.g[a]=[y.update,a,b],A(this),this;this.remove(a);b&&this.add(a,b)}return this};e.prototype.remove=function(a){if(this.a[a]){if(this.worker){var b=parseInt(this.a[a],10);this.i[b].postMessage(b,{remove:!0,id:a});delete this.a[a];return this}if(this.async)return this.g[a]||(this.c[this.c.length]=a),this.g[a]=[y.remove,a],A(this),this;for(b=0;10>b;b++)for(var d=Object.keys(this.b[b]),c=0;c<d.length;c++){var e=
d[c],f=this.b[b];if((f=f&&f[e])&&f.length)for(var k=0;k<f.length;k++)if(f[k]===a){f.splice(k,1);break}f.length||delete this.b[b][e]}delete this.a[a];this.s=!1}return this};e.prototype.search=function(a,b,d){a&&"object"===typeof a&&(d=a.callback||b,b=a.limit,a=a.query);"function"===typeof b?(d=b,b=1E3):b||(b=1E3);if(this.worker){this.u=d;this.m=0;this.h=[];for(var c=0;c<this.worker;c++)this.i[c].postMessage(c,{search:!0,limit:b,content:a});return null}if(d){var e=this;B(function(){d(e.search(a,b));
e=null},1,"search-"+this.id);return null}if(!a||"string"!==typeof a)return[];c=a;if(!this.s)this.cache&&(this.f="",this.j.reset()),this.s=!0;else if(this.cache){var f=this.j.get(a);if(f)return f}else if(this.f&&0===a.indexOf(this.f))return[];c=this.encode(c);if(!c.length)return[];var k=c.constructor===Array?c:c.split(D);c=k.length;1<c&&k.sort(v);var l=[],g=!0;f=[];for(var m={},n=0;n<c;n++){var p=k[n];if(p&&!m[p]){for(var r,u=!1,q=[],w=0,t=9;0<=t;t--)(r=this.b[t][p])&&r.length&&(q[w++]=r,u=!0);if(u)f[f.length]=
1<w?f.concat.apply([],q):q[0];else{g=!1;break}m[p]="1"}}if(g&&(c=f.length,1<c&&f.sort(G),w=0,r=f[w++])){for(;r.length&&w<c;)l=f[w++],r=H(r,l,w===c?b:0);b&&r.length>b&&r.splice(b,r.length-b);l=r}l.length?this.f="":this.f||(this.f=a);this.cache&&this.j.set(a,l);return l};e.prototype.info=function(){if(this.worker)for(var a=0;a<this.worker;a++)this.i[a].postMessage(a,{info:!0,id:this.id});else{for(var b,d,c=0,e=0,f=0,k=0;10>k;k++)for(b=Object.keys(this.b[k]),a=0;a<b.length;a++)d=this.b[k][b[a]].length,
c+=d+2*b[a].length+4,e+=d,f+=2*b[a].length;b=Object.keys(this.a);d=b.length;for(a=0;a<d;a++)c+=2*b[a].length+2;return{id:this.id,memory:c,items:d,sequences:e,chars:f,status:this.s,cache:this.c.length,matchers:u.length}}};e.prototype.reset=function(){this.destroy();return this.init()};e.prototype.destroy=function(){this.cache&&this.j.reset();this.j=this.a=this.b=null;return this};var q={icase:function(a){return a.toLowerCase()},simple:function(){var a=[c("[\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5]"),"a",
c("[\u00e8\u00e9\u00ea\u00eb]"),"e",c("[\u00ec\u00ed\u00ee\u00ef]"),"i",c("[\u00f2\u00f3\u00f4\u00f5\u00f6\u0151]"),"o",c("[\u00f9\u00fa\u00fb\u00fc\u0171]"),"u",c("[\u00fd\u0177\u00ff]"),"y",c("\u00f1"),"n",c("\u00e7"),"c",c("\u00df"),"s",c("[-/]")," ",c("[^a-z0-9 ]"),""];return function(b){return p(b.toLowerCase(),a)}}(),advanced:function(){var a=[c("ae"),"a",c("ai"),"ei",c("ay"),"ei",c("ey"),"ei",c("oe"),"o",c("ue"),"u",c("ie"),"i",c("sz"),"s",c("zs"),"s",c("sh"),"s",c("ck"),"k",c("cc"),"k",c("dt"),
"t",c("ph"),"f",c("ou"),"o",c("uo"),"u"];return function(b,d){if(!b)return b;b=q.simple(b);2<b.length&&(b=p(b,a));d||1<b.length&&(b=z(b));return b}}(),extra:function(){var a=[c("p"),"b",c("[sz]"),"c",c("[gq]"),"k",c("[jy]"),"i",c("n"),"m",c("d"),"t",c("[vw]"),"f",c("[aeiouy]"),""];return function(b){if(!b)return b;b=q.advanced(b,!0);if(1<b.length){b=b.split(" ");for(var d=0;d<b.length;d++){var c=b[d];1<c.length&&(b[d]=c[0]+p(c.substring(1),a))}b=b.join("");b=z(b)}return b}}(),ngram:function(a){var b=
[];if(!a)return b;a=q.advanced(a);if(!a)return b;for(var c=0,e=0,m=-1,f="",k=a.length,l=0;l<k;l++){var g=a[l];"a"===g||"e"===g||"i"===g||"o"===g||"u"===g||"y"===g?c++:e++;" "!==g&&(f+=g);if(" "===g||2<=c&&2<=e||l===k-1){if(f){c=f.length;if(2<c||" "===g||l===k-1){if(g=f.charCodeAt(0),1<c||48<=g||57>=g)b[++m]=f}else b[m]&&(b[m]+=f);f=""}e=c=0}}return b}},B=function(){var a={};return function(b,c,e){var d=a[e];d&&clearTimeout(d);return a[e]=setTimeout(b,c)}}(),J=function(){function a(){this.cache={}}
a.prototype.reset=function(){this.cache={}};a.prototype.set=function(a,c){this.cache[a]=c};a.prototype.get=function(a){return this.cache[a]};return a}();return e}(function(){var m={},x=!("undefined"===typeof Blob||"undefined"===typeof URL||!URL.createObjectURL);return function(e,c,p,t,z){var v=e;e=x?URL.createObjectURL(new Blob(["("+p.toString()+")()"],{type:"text/javascript"})):"../"+v+".js";v+="-"+c;m[v]||(m[v]=[]);m[v][z]=new Worker(e);m[v][z].onmessage=t;return{postMessage:function(c,e){m[v][c].postMessage(e)}}}}()),
this);
