/**!
 * FlexSearch.js v0.7.0-beta (Light)
 * Copyright 2019 Nextapps GmbH
 * Author: Thomas Wilkerling
 * Licence: Apache-2.0
 * https://github.com/nextapps-de/flexsearch
 */
(function(self){'use strict';function t(a){return"undefined"!==typeof a?a:!0}function v(a){const c=Array(a);for(let b=0;b<a;b++)c[b]=y();return c}function y(){return Object.create(null)}function z(a,c){return c.length-a.length};const A=/[\u0300-\u036f]/g;function B(a,c){const b=Object.keys(a),d=b.length,e=[];let h="",f=0;for(let g=0,k,n;g<d;g++)k=b[g],(n=a[k])?(e[f++]=new RegExp(c?"(?!\\b)"+k+"(\\b|_)":k,"g"),e[f++]=n):h+=(h?"|":"")+k;h&&(e[f++]=new RegExp(c?"(?!\\b)("+h+")(\\b|_)":"("+h+")","g"),e[f]="");return e}function C(a,c){for(let b=0,d=c.length;b<d&&(a=a.replace(c[b],c[b+1]),a);b+=2);return a};const D=/[\W_]+/;function F(a){a.normalize&&(a=a.normalize("NFD").replace(A,""));if(a=a.toLowerCase())if(this.o&&(a=C(a,this.o)),this.A&&1<a.length&&(a=C(a,this.A)),D||""===D)if(a=a.split(D),this.filter){var c=this.filter;const b=a.length,d=[];for(let e=0,h=0;e<b;e++){const f=a[e];f&&!c[f]&&(d[h++]=f)}a=d}return a};const G={},H={};function I(a,c,b,d){var e=a.length;let h=[],f,g,k=0;d&&(d=[]);for(--e;0<=e;e--){const n=a[e],p=n.length,q=y();let r=!f;for(let m=0;m<p;m++){const l=n[m],u=l.length;if(u)for(let E=0,x,w;E<u;E++)if(w=l[E],f){if(f[w]){if(!e)if(b)b--;else if(h[k++]=w,k===c)return h;if(e||d)q[w]=1;r=!0}if(d&&(g[w]=(x=g[w])?x++:x=1,x<p)){const M=d[x-1]||(d[x-1]=[]);M[M.length]=w}}else q[w]=1}if(d)f||(g=q);else if(!r)return[];f=q}if(d)for(let n=d.length-1,p,q;0<=n;n--){p=d[n];q=p.length;for(let r=0,m;r<q;r++)if(m=p[r],!f[m]){if(b)b--;
else if(h[k++]=m,k===c)return h;f[m]=1}}return h};function J(a,c){if(!(this instanceof J))return new J(a);let b;if(a){var d=a.charset;b=a.lang;"string"===typeof d&&(-1===d.indexOf(":")&&(d+=":default"),d=H[d]);"string"===typeof b&&(b=G[b])}else a={};let e,h,f=a.context||{};this.encode=a.encode||d&&d.encode||F;this.register=c||y();this.v=e=a.resolution||9;this.C=c=d&&d.C||a.tokenize||"strict";this.j="strict"===c&&f.depth;this.l=t(f.bidirectional);this.g=h=t(a.optimize);this.s=t(a.fastupdate);this.h=a.minlength||1;this.i=h?v(e):y();this.B=e=f.resolution||
1;this.m=h?v(e):y();this.u=d&&d.u||a.rtl;this.o=(c=a.matcher||b&&b.o)&&B(c,!1);this.A=(c=a.stemmer||b&&b.A)&&B(c,!0);if(a=c=a.filter||b&&b.filter){a=c;d=y();for(let g=0,k=a.length;g<k;g++)d[a[g]]=1;a=d}this.filter=a}J.prototype.append=function(a,c){return this.add(a,c,!0)};
J.prototype.add=function(a,c,b,d){if(!d&&!b&&this.register[a])return this.update(a,c);if(c&&(a||0===a)&&(c=this.encode(c),d=c.length)){const n=this.j,p=this.v,q=y(),r=y();for(let m=0;m<d;m++){let l=c[this.u?d-1-m:m];var e=l.length;if(l&&e>=this.h&&(n||!q[l])){var h=K(p,d,m),f="";switch(this.C){case "full":if(3<e){for(h=0;h<e;h++)for(var g=e;g>h;g--)if(g-h>=this.h){var k=K(p,d,m,e,h);f=l.substring(h,g);L(this,q,f,k,a,b)}break}case "reverse":if(2<e){for(g=e-1;0<g;g--)f=l[g]+f,f.length>=this.h&&L(this,
q,f,K(p,d,m,e,g),a,b);f=""}case "forward":if(1<e)for(g=0;g<e;g++)f+=l[g],f.length>=this.h&&L(this,q,f,h,a,b);break;default:if(L(this,q,l,h,a,b),n&&1<d&&m<d-1)for(e=this.B,f=y(),h=l,g=Math.min(n+1,d-m),f[h]=1,k=1;k<g;k++)if((l=c[this.u?d-1-m-k:m+k])&&l.length>=this.h&&!f[l]){f[l]=1;const u=this.l&&l>h;L(this,r,u?h:l,K(e+(d/2>e?0:1),d,m,g-1,k-1),a,b,u?l:h)}}}}this.s||(this.register[a]=1)}return this};function K(a,c,b,d,e){return b&&1<a?c+(d||0)<=a?b+(e||0):(a-1)/(c+(d||0))*(b+(e||0))+1|0:0}
function L(a,c,b,d,e,h,f){let g=f?a.m:a.i;if(!c[b]||f&&!c[b][f])a.g&&(g=g[d]),f?(c=c[b]||(c[b]=y()),c[f]=1,g=g[f]||(g[f]=y())):c[b]=1,g=g[b]||(g[b]=[]),a.g||(g=g[d]||(g[d]=[])),h&&-1!==g.indexOf(e)||(g[g.length]=e,a.s&&(a=a.register[e]||(a.register[e]=[]),a[a.length]=g))}
J.prototype.search=function(a,c,b){"object"===typeof a?(b=a,a=b.query):"object"===typeof c&&(b=c);let d=[],e;let h,f=0;if(b){c=b.limit;f=b.offset||0;var g=b.context;h=!1}if(a&&(a=this.encode(a),e=a.length,1<e)){b=y();var k=[];for(let p=0,q=0,r;p<e;p++)if((r=a[p])&&r.length>=this.h&&!b[r])if(this.g||h||this.i[r])k[q++]=r,b[r]=1;else return d;a=k;e=a.length}if(!e)return d;c||(c=100);g=this.j&&1<e&&!1!==g;b=0;let n;g?(n=a[0],b=1):1<e&&a.sort(z);for(let p,q;b<e;b++){q=a[b];g?(p=N(this,d,h,c,f,2===e,q,
n),h&&!1===p&&d.length||(n=q)):p=N(this,d,h,c,f,1===e,q);if(p)return p;if(h&&b===e-1){k=d.length;if(!k){if(g){g=0;b=-1;continue}return d}if(1===k)return O(d[0],c,f)}}return I(d,c,f,h)};
function N(a,c,b,d,e,h,f,g){let k=[],n=g?a.m:a.i;a.g||(n=P(n,f,g,a.l));if(n){let p=0;const q=Math.min(n.length,g?a.B:a.v);for(let r=0,m=0,l,u;r<q;r++)if(l=n[r])if(a.g&&(l=P(l,f,g,a.l)),e&&l&&h&&(u=l.length,u<=e?(e-=u,l=null):(l=l.slice(e),e=0)),l&&(k[p++]=l,h&&(m+=l.length,m>=d)))break;if(p){if(h)return O(k,d,0);c[c.length]=k;return}}return!b&&k}function O(a,c,b){a=1===a.length?a[0]:[].concat.apply([],a);return b||a.length>c?a.slice(b,b+c):a}
function P(a,c,b,d){b?(d=d&&c>b,a=(a=a[d?c:b])&&a[d?b:c]):a=a[c];return a}J.prototype.contain=function(a){return!!this.register[a]};J.prototype.update=function(a,c){return this.remove(a).add(a,c)};J.prototype.remove=function(a,c){const b=this.register[a];if(b){if(this.s)for(let d=0,e;d<b.length;d++)e=b[d],e.splice(e.indexOf(a),1);else Q(this.i,a,this.v,this.g),this.j&&Q(this.m,a,this.B,this.g);c||delete this.register[a]}return this};
function Q(a,c,b,d,e){let h=0;if(a.constructor===Array)if(e)c=a.indexOf(c),-1!==c?1<a.length&&(a.splice(c,1),h++):h++;else{e=Math.min(a.length,b);for(let f=0,g;f<e;f++)if(g=a[f])h=Q(g,c,b,d,e),d||h||delete a[f]}else for(let f in a)(h=Q(a[f],c,b,d,e))||delete a[f];return h};const R=self;let S;const T={Index:J,Document:null,Worker:null,registerCharset:function(a,c){H[a]=c},registerLanguage:function(a,c){G[a]=c}};(S=R.define)&&S.amd?S([],function(){return T}):R.exports?R.exports=T:R.FlexSearch=T;}(this));
